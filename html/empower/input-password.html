<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="maximum-scale=1.0, minimum-scale=1.0, user-scalable=0, initial-scale=1.0, width=device-width"
  />
  <meta name="format-detection" content="telephone=no, email=no, date=no, address=no">
  <title>登录</title>
  <link rel="stylesheet" type="text/css" href="../../css/empower/input-password.css">
</head>

<body>
  <header class="header">
    <img src="../../image/common/back.png" class="back" onclick="javascript: kill();">
    <p class="header-title">登录</p>
  </header>
  <div class="logo">
    <img src="../../image/logo.png" class="logo-img">
    <p class="userphone">1845848888</p>
  </div>
  <div class="login">
    <div class="areacode">
      <span>密码</span>
    </div>
    <input type="password" placeholder="请输入您的登录密码" class="pass">
    <img src="../../image/common/switch.png" class="switch">
    <img src="../../image/common/clear.png" class="clearpass">

    <button class="btn" onclick="javascript: submit();">登录</button>
    <p class="forgetpass" onclick="javascript: create('forget-password');">忘记密码</p>
  </div>
  <script type="text/javascript" charset="utf-8" src="../../script/global/api.js"></script>
  <script type="text/javascript" charset="utf-8" src="../../script/global/request.js"></script>
  <script type="text/javascript" charset="utf-8" src="../../script/global/request-status.js"></script>
  <script type="text/javascript" charset="utf-8" src="../../script/component/router.js"></script>
  <script type="text/javascript" charset="utf-8" src="../../script/component/base.js"></script>
  <script type="text/javascript" charset="utf-8" src="../../script/component/check/checkPhone.js"></script>
  <script type="text/javascript" charset="utf-8" src="../../script/component/check/checkPassword.js"></script>
  <script type="text/javascript" charset="utf-8" src="../../script/component/other/toggleBtnDisabled.js"></script>
  <script type="text/javascript" charset="utf-8">
    function submit() {
      var account = api.pageParam.account;
      var password = $api.val('password');
      if (checkPassword(password)) return;

      request({
        url: 'xxxxx',
        values: {
          account: account,
          password: password
        },
        showMessage: '正在登录...',
        init: function () {
          closeBtnClick('submit-btn');
        },
        success: function (data) {
          setLoginStatus(data);
          sendLoginEvent();
          kill(['login', '']);
        },
        default: function () {
          openBtnClick('submit-btn');
        }
      });
    }

        function setLoginStatus(data) {
            User = $api.getStorage('User');
            User.Status = true;
            for (const key in data) {
              if (data.hasOwnProperty(key)) User[key] = object[key];
            }
            $api.setStorage('User', User);
          }


        function sendLoginEvent() {
            api.sendEvent({ name: 'LOGIN-EVENT' });
          }
  </script>
</body>

</html>
