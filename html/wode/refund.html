<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="maximum-scale=1.0, minimum-scale=1.0, user-scalable=0, initial-scale=1.0, width=device-width"
  />
  <meta name="format-detection" content="telephone=no, email=no, date=no, address=no">
  <title>退款</title>
  <link rel="stylesheet" type="text/css" href="../../css/wode/refund.css">
</head>

<body>

  <header class="header">
    <img src="../../image/common/back.png" class="back" onclick="javascript: kill();">
    <p class="header-title">退款</p>
  </header>
  <div class="content">
    <div class="money">
      <p class="sum">应退金额</p>
      <span class="price" id="price">800.00</span>
      <a href="javascript:;" class="explain">
        <img src="../../image/wode/help.png">
        <span class="explain-text">说明</span>
      </a>
    </div>
    <div class="select">
      <p>选择退款方式</p>
    </div>
    <div class="bank">
      <ul class="banklist">
        <li>
          <div class="pay-type">
            <img src="../../image/wode/chinabank.png" class="chinabank">
            <p class="bank-name">中国银行</p>
            <p class="cardnum">
              <span class="pass">****</span>
              <span class="pass">****</span>
              <span class="pass">****</span>
              <span class="num" id="card-tail">5925</span>
              <span class="card-type">储蓄卡</span>
            </p>
          </div>
          <img src="../../image/wode/select.png" class="select" id="card-select" onclick="javascript:select(this);">
        </li>
        <!-- <li>
          <div class="pay-type">
            <img src="../../image/wode/alipay.png" class="alipay">
            <div class="item-content">
              <p class="bank-name">支付宝</p>
              <p class="message">(支付宝将另收取2元支付通道费)</p>
            </div>
          </div>
          <div class="selectd select" id="ali-select">
            <img src="../../image/wode/check.png">
          </div>
        </li> -->
      </ul>
    </div>
  </div>
  </div>
  <button class="btn">确认退款</button>
  <script type="text/javascript" charset="utf-8" src="../../script/global/api.js"></script>
  <script type="text/javascript" charset="utf-8" src="../../script/global/request.js"></script>
  <script type="text/javascript" charset="utf-8" src="../../script/global/request-status.js"></script>
  <script type="text/javascript" charset="utf-8" src="../../script/component/router.js"></script>
  <script type="text/javascript" charset="utf-8" src="../../script/component/base.js"></script>
  <script type="text/javascript" charset="utf-8" src="../../script/global/urls.js"></script>
  <script type="text/javascript" charset="utf-8">
      
      var onOff = true;

    apiready = function () {
      init();
      var onOff = true;
    }

      function select(obj){
        if(onOff){
          obj.src = '../../image/wode/check.png';
        }else{
          obj.src = '../../image/wode/select.png';
        }
        onOff = !onOff;
      }

    function init() {
      if (!checkNet() || !checkLogin()) return;
      request({
        url: 'PaymentAmount',
        data: {},
        operation: {
          success: function (data) {
            data = formatData(data);
            render(data);
          },
          default: function () {}
        }
      });
    }

    function selectCard() {
      if ($api.hasCls('card-select', 'selectd')) {
        $api.removeCls('ali-select', 'selectd');
        $api.addCls('card-select', 'selectd');
      }
    }

    function selectALi() {
      if ($api.hasCls('ali-select', 'selectd')) {
        $api.removeCls('card-select', 'selectd');
        $api.addCls('ali-select', 'selectd');
      }
    }

    function submit() {
      if (!checkNet() || !checkLogin()) return;
      request({
        url: 'PaymentAmount',
        data: {},
        operation: {
          success: function (data) {
            render(data);
          },
          default: function () {}
        }
      });
    }

    function render(data) {
      $api.text('price', data.price);
      $api.text('card-tail', data.tail);
    }

    function formatData(data) {
      User = $api.getStorage('User');
      return {
        data: data.ZongJinE - data.YiJieFeiYong,
        tail: User.Card.substr(-4)
      }
    }
  </script>
</body>

</html>
